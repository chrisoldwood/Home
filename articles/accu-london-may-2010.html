<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="accu-london-may-2010_files/filelist.xml">
<title>ACCU London - May 2010</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Chris Oldwood</o:Author>
  <o:LastAuthor>Chris Oldwood</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>109</o:TotalTime>
  <o:Created>2011-09-12T18:01:00Z</o:Created>
  <o:LastSaved>2011-09-12T18:01:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>633</o:Words>
  <o:Characters>3611</o:Characters>
  <o:Company>Co Productions Ltd</o:Company>
  <o:Lines>30</o:Lines>
  <o:Paragraphs>8</o:Paragraphs>
  <o:CharactersWithSpaces>4236</o:CharactersWithSpaces>
  <o:Version>11.9999</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:UseWord2002TableStyleRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:EN-GB;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;
	width: 600px;
	margin-left: auto;
	margin-right: auto;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US style='tab-interval:36.0pt'>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><u><span lang=EN-GB>ACCU London - May 2010</span></u></p>

<p class=MsoNormal align=center style='text-align:center'><u><span lang=EN-GB>Kevlin
Henney: Rethinking Unit Testing in C++<o:p></o:p></span></u></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>The <st1:City w:st="on"><st1:place w:st="on">London</st1:place></st1:City>
branch of the ACCU met up once again in May at one of the SkillsMatter offices
for a presentation by Kevlin Henney. There was a good turnout of around 20,
with a few new faces to boot. That wasn’t overly surprising given that Kevlin
is a renowned speaker – I’ve seen him speak a number of times at the ACCU
conference and found his material to be very insightful, with a dash of dry
humour and controversy to keep you on your toes.</span></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>For the most part I think the C++ suffix in
the presentation’s title was a little superfluous. Yes, he was demonstrating with
examples in C++, but much of the message was clearly language agnostic. The
first half illustrated the evolution of unit testing from a bunch of random
chunks of ‘test’ code through to an organised set of tests that had a
significant air of “Formal Specification” about it. The initial tests were
really just a stream of consciousness laid out sequentially in a single scope
with no attention paid to structure and consequently future maintenance costs.
This was then evolved into a procedural style whereby the tests were
partitioned around the (member) functions under test. One of the main issues
with this style is that it’s impossible not to use the same functions in other
test methods, which makes the idea of isolated tests and order independence somewhat
moot.</span></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>The next progression was coined
‘contextual’ whereby the partitioning was biased towards ‘behaviours’ or
‘features’ rather than the implementation. By this point the names of the tests
started to follow natural language rather than the more terse method naming we
use daily and Kevlin described how some developers find this transition
difficult because they’re not used to such expression. Although not as rigid,
the style was reminiscent of the BDD Given/When/Then form with the test name
resembling a proposition rather than an exclamation. The judicious application
of macros meant that the source file was taking on a more formal shape with a
SPECIFICATION at the top, followed by a series of PROPOSITIONs. But, not only
did the code appear more formal, the output from the tests had a more intention
revealing feel about it. Nat Pryce and Steve Freeman gave a talk a few months
back about TDD in which they highlighted the importance of the test diagnostics
and these ideas certainly enhanced that message.</span></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>A brief diversion into unit testing C++
code with NUnit &amp; C++/CLI then followed. Once again the aid of a few macros
helped to hide away the test method attributes and static Assert invocations so
that visually the code appeared just like the native versions. Kevlin admitted
that there are limitations to this technique, but it was a good first
approximation that showed a nice meshing of the two ‘meta’ techniques – .Net
reflection and C/C++ pre-processing.</span></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>For his grand finale Kevlin showed how he
could capture the expression being asserted. However this was not only in
textual form, but also in programmatic form so that the output for a test
failure would display the failed expression <i style='mso-bidi-font-style:normal'>and</i>
the values of the variables used within that expression. Naturally the audience
wanted to see behind the curtain and we quickly found ourselves staring into
Expression Template territory. Kevlin only had a partial implementation due to
time constraints, but there was already a significant body of template code.
The most interesting aspect was the choice of operator used to allow the code to
work its magic by ‘capturing’ the leftmost part of the assert expression – it needed
to be overloadable, practically unused and higher than those you would normally
find inside assert expressions. The proverbial rabbit that he pulled out of the
hat was the ‘-&gt;*’ operator which I readily confess to not knowing, but promptly
Googled when I got home.</span></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>Not that I departed for home the moment the
bell went as there was still the matter of post-discussion beer which was
satisfied by The Slaughtered Lamb. Fortunately we had a few of the non-members
join us in the pub afterwards which gave us ample opportunity to slip The King’s
Shilling into their pint…</span></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-GB>Chris Oldwood</span></p>

<p class=MsoNormal><!--[if supportFields]><span lang=EN-GB><span
style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'> </span>SAVEDATE<span style='mso-spacerun:yes'> 
</span>\@ &quot;dd/MM/yyyy&quot;<span style='mso-spacerun:yes'>  </span>\*
MERGEFORMAT <span style='mso-element:field-separator'></span></span><![endif]--><span
lang=EN-GB><span style='mso-no-proof:yes'>24/05/2010</span></span><!--[if supportFields]><span
lang=EN-GB><span style='mso-element:field-end'></span></span><![endif]--></p>

<p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
